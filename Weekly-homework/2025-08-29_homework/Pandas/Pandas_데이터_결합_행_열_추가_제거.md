
---

# 📌 판다스 데이터 결합/추가/삭제 요약 (GitHub/Notion 용)

---

## 1️⃣ `merge` — 공통 키로 테이블 결합

| 매개변수                        | 설명                                                                                 | 실무 포인트                                |
| --------------------------- | ---------------------------------------------------------------------------------- | ------------------------------------- |
| `how`                       | `'inner'` (교집합), `'left'` (왼쪽+교집합), `'right'` (오른쪽+교집합), `'outer'` (합집합, 없는 건 NaN) | 기본은 `inner`, 라벨링 작업 시 `left` 자주 사용    |
| `on`                        | 공통 키                                                                               | 컬럼명이 같을 때                             |
| `left_on`, `right_on`       | 키 이름이 다를 때 각각 지정                                                                   | `user_id` vs `id`                     |
| `left_index`, `right_index` | 인덱스를 키로 사용                                                                         | 시계열 데이터 합칠 때 유용                       |
| `suffixes`                  | 중복 컬럼 접미사 지정                                                                       | `('', '_r')` 처럼 깔끔하게 정리               |
| `indicator`                 | `_merge` 컬럼 추가                                                                     | `left_only`, `right_only`, `both` 확인용 |
| `validate`                  | `'1:1'`, `'1:m'`, `'m:1'`, `'m:m'` 검증                                              | 중복키로 폭발하는 문제 조기 방지                    |

---

## 2️⃣ `join` — 인덱스 기반 결합

| 매개변수                 | 설명                                        | 실무 포인트                           |
| -------------------- | ----------------------------------------- | -------------------------------- |
| `on`                 | df1의 컬럼 vs df2 인덱스                        | `df2.set_index('id')` 후 조인       |
| `how`                | `'left'`, `'right'`, `'inner'`, `'outer'` | 기본은 `left`                       |
| `lsuffix`, `rsuffix` | 겹치는 컬럼명 구분                                | join 충돌 방지                       |
| 특징                   | 인덱스 기반 결합, 코드 짧음                          | 여러 DF 한 번에 `join([df2, df3])` 가능 |

---

## 3️⃣ `concat` — 단순 이어붙이기

| 매개변수               | 설명                               | 실무 포인트                       |
| ------------------ | -------------------------------- | ---------------------------- |
| `axis`             | `0`: 행 추가(스택) <br>`1`: 열 추가(옆으로) | `append`는 제거됐으니 무조건 `concat` |
| `join`             | `'outer'`: 합집합, `'inner'`: 교집합   | `join='inner'`로 공통 피처만 유지    |
| `ignore_index`     | 인덱스 새로 부여                        | 데이터셋 합칠 때 필수                 |
| `keys`             | 상위 레벨(MultiIndex) 생성             | `train/test` 구분 시 유용         |
| `verify_integrity` | 중복 인덱스 에러 발생                     | 대형 데이터 합칠 때 안정성 ↑            |

---

## 4️⃣ 인덱스 다루기 (`set_index / reset_index / rename_axis`)

| 메서드           | 매개변수                       | 설명 / 실무 포인트                            |
| ------------- | -------------------------- | -------------------------------------- |
| `set_index`   | `drop`, `append`           | 컬럼을 인덱스로 올리기. `append=True`면 기존 인덱스 보존 |
| `reset_index` | `drop`, `level`, `inplace` | 인덱스를 컬럼으로 내리기. `drop=True`면 버림         |
| `rename_axis` | `columns=`                 | 인덱스나 컬럼 축 이름 지정                        |

---

## 5️⃣ `drop` — 행/열 제거

| 매개변수      | 설명                   | 실무 포인트                        |
| --------- | -------------------- | ----------------------------- |
| `labels`  | 제거할 라벨               | 보통 `index`/`columns` 인자 직접 사용 |
| `axis`    | `0`: 행, `1`: 열       |                               |
| `index`   | 제거할 행 지정             | `df.drop(index=[0,1])`        |
| `columns` | 제거할 열 지정             | `df.drop(columns=['Name'])`   |
| `level`   | MultiIndex 특정 레벨 제거  |                               |
| `errors`  | `'ignore'`: 없는 라벨 무시 | 안정성 ↑                         |

---

## 6️⃣ 중복 제거 (`drop_duplicates / duplicated`)

| 메서드               | 매개변수                             | 설명 / 실무 포인트                             |
| ----------------- | -------------------------------- | --------------------------------------- |
| `drop_duplicates` | `subset`, `keep`, `ignore_index` | 특정 컬럼 조합 유니크 유지. `keep=False`면 중복 전부 제거 |
| `duplicated`      | `subset`, `keep`                 | 중복 여부만 확인 (True/False 마스크)              |

---

## 7️⃣ 실무에서 자주 막히는 포인트

| 문제                       | 처방                                 |
| ------------------------ | ---------------------------------- |
| dtype 불일치로 merge 결과 비어있음 | `astype` 맞추기 (`int64` vs `string`) |
| 문자열 공백/대소문자 차이           | `.str.strip().str.lower()` 전처리     |
| 중복키로 행 폭증                | `validate='1:m'` 옵션으로 방지           |
| outer 후 누락 원인 추적         | `indicator=True` 후 `_merge` 확인     |
| concat 후 인덱스 꼬임          | `ignore_index=True`                |
| join에서 컬럼 충돌             | `lsuffix`, `rsuffix`               |

---

## 8️⃣ 추천 사용 구분

| 상황            | 추천 메서드            |
| ------------- | ----------------- |
| 키(컬럼)로 관계형 결합 | `merge`           |
| 인덱스 기준 짧은 결합  | `join`            |
| 단순 위/옆 연결     | `concat`          |
| 행/열 삭제        | `drop`            |
| 중복 제거         | `drop_duplicates` |
| 시계열 근접 매칭     | `merge_asof`      |
| 정렬 보존 병합/보간   | `merge_ordered`   |

---

