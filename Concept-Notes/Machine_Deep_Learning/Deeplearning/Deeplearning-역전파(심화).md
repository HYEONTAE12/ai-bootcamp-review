

---

# π“ μ—­μ „ν μ‹¬ν™” μ™„μ „ μ •λ³µ λ…ΈνΈ π―

## π“ κΈ°λ³Έ ν‘κΈ°λ²•

### zμ™€ aμ μ°¨μ΄

* **z (ν™μ„±ν™” ν•¨μ μ…λ ¥κ°’)**:
  [
  z^l = W^l \cdot a^{l-1} + b^l
  ]
  β†’ κ°€μ¤‘μΉΒ·νΈν–¥κΉμ§€ λ”ν•, μ•„μ§ ν™μ„±ν™” ν•¨μλ¥Ό ν†µκ³Όν•μ§€ μ•μ€ κ°’

* **a (ν™μ„±ν™” ν•¨μ μ¶λ ¥κ°’)**:
  [
  a^l = \sigma(z^l)
  ]
  β†’ zμ— ν™μ„±ν™” ν•¨μλ¥Ό μ μ©ν• κ°’, λ‹¤μ λ μ΄μ–΄μ μ…λ ¥μ΄ λ¨

**μμ‹**

```
μ…λ ¥: a^1 = [0.5, 0.3]
κ°€μ¤‘μΉ: W^2 = [[0.4, 0.6], [0.1, 0.9]]
νΈν–¥: b^2 = [0.2, 0.1]

W^2 Β· a^1 = [0.38, 0.32]
z^2 = [0.38, 0.32] + [0.2, 0.1] = [0.58, 0.42]
a^2 = Οƒ(z^2) β‰ [0.641, 0.603]
```

---

## π― μ†μ‹¤ ν•¨μμ 2κ°€μ§€ κΈ°λ³Έ κ°€μ •

### 1. μ΄ μ†μ‹¤ = κ° μƒν” μ†μ‹¤μ ν‰κ· 

[
C = \frac{1}{n}\sum_x C_x
]

* μ „μ²΄ μ†μ‹¤μ„ κ³„μ‚°ν•κΈ° μ–΄λ ¤μ°λ―€λ΅, κ° μƒν” μ†μ‹¤λ§ κµ¬ν•΄μ„ ν•©μ‚°/ν‰κ· 
* λ―Έλ¶„λ„ λ™μΌ:
  [
  \frac{\partial C}{\partial w} = \sum_x \frac{\partial C_x}{\partial w}
  ]

π‘‰ **ν• μƒν” λ‹¨μ„λ΅ μ—­μ „νλ¥Ό μ΄ν•΄ν•΄λ„ OK!**

---

### 2. μ†μ‹¤μ€ μµμΆ… μ¶λ ¥ (a^L)μ ν•¨μ

* μ¤‘κ°„ λ μ΄μ–΄ μ¶λ ¥μ„ μ§μ ‘ μ“°μ§€ μ•μ β†’ μ—­μ „ν λ‹¨μν™”
* μμ‹:

  * β… κ°€λ¥:
    [
    C = \tfrac{1}{2}|y - a^L|^2
    ]
  * β λ¶κ°€λ¥:
    [
    C = f(a^2, a^3, a^L)
    ]

---

## π”¥ μ—­μ „ν 4λ€ λ°©μ •μ‹

### 1. μ¶λ ¥μΈµ μ—λ¬ Ξ΄^L

[
\delta^L_j = \frac{\partial C}{\partial a^L_j}\cdot \sigma'(z^L_j)
]

* μ¶λ ¥κ°’μ΄ μ†μ‹¤μ— λ―ΈμΉλ” μν–¥ Γ— ν™μ„±ν™” ν•¨μμ λ―Όκ°λ„
* μ΄μ°¨ μ†μ‹¤ ν•¨μμΌ λ•:
  [
  \delta^L = (a^L - y) \odot \sigma'(z^L)
  ]

---

### 2. μ΄μ „ λ μ΄μ–΄ μ—λ¬ Ξ΄^l

[
\delta^l = (W^{l+1})^T \delta^{l+1} \odot \sigma'(z^l)
]

* **μ—°μ‡„λ²•μΉ™**μΌλ΅λ¶€ν„° μ λ„
* β€λ‹¤μ λ μ΄μ–΄μ μ—λ¬κ°€ ν„μ¬ λ μ΄μ–΄λ΅ μ „νλλ” κ³Όμ •β€

---

### 3. νΈν–¥μ— λ€ν• κ·Έλλ””μ–ΈνΈ

[
\frac{\partial C}{\partial b^l_j} = \delta^l_j
]

* νΈν–¥μ€ λ‹¨μν λ”ν•΄μ§€λ―€λ΅, μ—λ¬ Ξ΄^l μμ²΄κ°€ κ·Έλλ””μ–ΈνΈκ°€ λ¨

---

### 4. κ°€μ¤‘μΉμ— λ€ν• κ·Έλλ””μ–ΈνΈ

[
\frac{\partial C}{\partial w^l_{jk}} = a^{l-1}_k \cdot \delta^l_j
]

ν–‰λ ¬ ν•νƒ:
[
\nabla_{W^l} C = \delta^l \cdot (a^{l-1})^T
]

π‘‰ μ°¨μ›κΉμ§€ λ”± λ§μ•„λ–¨μ–΄μ§

---

## π¬ μ—­μ „ν μ•κ³ λ¦¬μ¦ μ „μ²΄ νλ¦„

1. **μ…λ ¥ μ„¤μ •**
   [
   a^1 = x
   ]

2. **μμ „ν**
   [
   z^l = W^l a^{l-1} + b^l, \quad a^l = \sigma(z^l)
   ]

3. **μ¶λ ¥μΈµ μ—λ¬ κ³„μ‚°**
   [
   \delta^L = \nabla_a C \odot \sigma'(z^L)
   ]

4. **μ—­μ „ν**
   [
   \delta^l = (W^{l+1})^T \delta^{l+1} \odot \sigma'(z^l)
   ]

5. **κ·Έλλ””μ–ΈνΈ κ³„μ‚°**
   [
   \frac{\partial C}{\partial W^l} = \delta^l (a^{l-1})^T,\quad
   \frac{\partial C}{\partial b^l} = \delta^l
   ]

---

## π’΅ μ¤‘μ”ν• μΈμ‚¬μ΄νΈ

### 1. λ‚®μ€ ν™μ„±ν™” λ‰΄λ°

* (a^{l-1}*k \approx 0 \implies \frac{\partial C}{\partial w^l*{jk}} \approx 0)
* λ‰΄λ°μ΄ κ±°μ μ£½μ–΄μμΌλ©΄ κ°€μ¤‘μΉ μ—…λ°μ΄νΈκ°€ κ±°μ μ—†μ β†’ ν•™μµ λλ ¤μ§

### 2. ν¬ν™”λ λ‰΄λ°

* Οƒ(z)κ°€ 0 λλ” 1μ— κ°€κΉμ°λ©΄ Οƒ'(z) β‰ 0
* Ξ΄ β‰ 0 β†’ **κ·Έλλ””μ–ΈνΈ μ†μ‹¤ λ¬Έμ  λ°μƒ**

---

## π― νλΌλ―Έν„° μ—…λ°μ΄νΈ

κ²½μ‚¬ν•κ°•λ²•:
[
W^l \leftarrow W^l - \frac{\eta}{m}\sum_x \delta^{(x,l)} (a^{(x,l-1)})^T
]
[
b^l \leftarrow b^l - \frac{\eta}{m}\sum_x \delta^{(x,l)}
]

* Ξ·: ν•™μµλ¥ 
* m: λ―Έλ‹λ°°μΉ ν¬κΈ°

---

## β… μ •λ¦¬

* μ—­μ „νλ” μ—°μ‡„λ²•μΉ™μ„ ν™μ©ν•΄ ν¨μ¨μ μΌλ΅ λ¨λ“  κ·Έλλ””μ–ΈνΈλ¥Ό κµ¬ν•λ‹¤.
* κ° μΈµμ μ—λ¬ Ξ΄λ¥Ό κ³„μ‚°ν•κ³ , μ΄λ¥Ό ν†µν•΄ Wμ™€ bμ— λ€ν• λ―Έλ¶„μ„ μ†μ‰½κ² κµ¬ν•λ‹¤.
* λ¨λ“  νλΌλ―Έν„°λ” β€μ†μ‹¤μ„ μ¤„μ΄λ” λ°©ν–¥(β€“β‡C)β€μΌλ΅ λ™μ‹μ— μ—…λ°μ΄νΈλλ‹¤.

---


