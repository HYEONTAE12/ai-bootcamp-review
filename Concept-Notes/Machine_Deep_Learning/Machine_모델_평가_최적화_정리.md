
---

# 📘 모델 평가와 최적화 정리

## 1. 모델 평가의 필요성

* 모델 평가는 단순 점수 매기기가 아니라 **서비스 적용 전 안전성 검증** 과정.
* 편향이나 사회적 위험(원숭이 손, 종이클립 아포칼립스, 추천 알고리즘의 사회 분열 등)을 고려해야 함.

---

## 2. 평가 방법

### 🔹 정량 평가 (Quantitative Evaluation)

* 수치로 성능을 측정.
* **데이터셋 분할**

  * Train: 학습용
  * Validation: 하이퍼파라미터 튜닝
  * Test: 최종 성능 확인
* **잘못된 분할 문제**

  * 데이터 누출 (Leakage)
  * 대표성 부족
* **분할 방법**

  * 2분할, 3분할, k-fold 교차검증
  * 작은 데이터: 50:50
  * 보통: 7:1:2
  * 매우 큰 데이터: 대부분 학습, 소량 검증/평가
  * 계층적 분할(Stratified Split): 희귀 클래스 균형 유지

#### 주요 지표

* **분류**

  * 혼동 행렬: TN, TP, FP, FN
  * 정밀도(Precision): 예측 양성 중 실제 양성 비율
  * 재현율(Recall): 실제 양성 중 모델이 맞춘 비율
  * F1 스코어: Precision & Recall의 조화평균
  * ROC-AUC: 모든 임계값에서의 분류 성능 종합
* **회귀**

  * MAE, MSE, RMSE
* **시스템 성능**

  * 인퍼런스 시간, 처리율, 메모리 사용량

👉 **지표 선택 팁**

* MAE: 작은 오차 전체가 중요할 때
* MSE: 이상치 영향 크게 보고 싶을 때
* 상황에 따라 지표 가중합(예: 0.3*A셋 + 0.7*B셋)

---

### 🔹 정성 평가 (Qualitative Evaluation)

* 사람이 직접 모델 출력을 보고 평가.
* **필요성**

  * 정량 평가만으로는 드러나지 않는 문제 확인 (이상한 오답 패턴, OCR 등)
* **어려움**

  * 주관적이고 확장성 낮음
* **지속 가능성 확보 방법**

  * 샘플 관찰 계획 세우기
  * 소규모 정성평가부터 시작
  * 발견된 이슈 기록 및 분류

---

## 3. 모델 최적화

### 모델 복잡도

* 과소적합(Underfitting): 모델이 너무 단순 → 패턴 못 잡음
* 과적합(Overfitting): 모델이 너무 복잡 → 훈련셋에만 과도하게 맞춤

### Bias–Variance Trade-off

* **Bias↑** → 단순 모델, 과소적합
* **Variance↑** → 복잡 모델, 과적합
* **총 에러 = Bias² + Variance + Noise**

### 학습곡선

* **정상 학습**: Train/Validation Loss 모두 감소 후 안정
* **과적합**: Train Loss ↓↓, Validation Loss ↘ 후 ↑
* **과소적합**: Train/Validation Loss 모두 높고 잘 줄지 않음

---

## 4. 과적합 해결 방법

1. **데이터 증강/수집**
2. **정규화**

   * L1: 희소화(불필요 변수 제거)
   * L2: 큰 가중치 억제
   * Dropout (신경망)
3. **Early Stopping** (검증 성능이 더 나빠지면 학습 중단)
4. **모델 단순화** (파라미터 수 줄이기, 깊이 얕게)
5. **학습곡선 모니터링**

---

## 5. 베이스라인 & 리더보드

* **Random baseline**: 무작위 예측 성능
* **Model baselines**: 간단한 전통적 모델 성능
* **리더보드**: 모델 비교 순위표 (예: Kaggle)
* **SOTA (State of the Art)**: 현재 최고 성능
* **Bayes Optimal Error**: 어떤 모델도 넘을 수 없는 최소 오류율
* **Human Performance**: 사람이 달성하는 수준

---

## ✅ 기억하기 쉽게 요약

* **정량 평가 = 숫자, 정성 평가 = 느낌** → 둘 다 필요
* **정확도 하나만 믿지 말라** (의료 진단 예시)
* **Precision = 내가 찍은 게 얼마나 정답?**
* **Recall = 정답 중에 내가 얼마나 맞췄나?**
* **F1 = 균형**
* **AUC = 전체 흐름**
* **과소적합 = 공부 부족, 과적합 = 문제집만 달달**
* **Trade-off** = Bias(단순) vs Variance(복잡)

---

