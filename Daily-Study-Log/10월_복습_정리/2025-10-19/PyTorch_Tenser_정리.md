

---

# 📘 텐서(Tensor)와 관련 개념 정리

## 🔹 Tensor란?

* **정의**: 다차원 배열(Array)을 의미.
* 예시:

  * **0차원 텐서 (Scalar)**: 숫자 한 개 (예: 7)
  * **1차원 텐서 (Vector)**: 숫자의 리스트 (예: [1, 2, 3])
  * **2차원 텐서 (Matrix)**: 행렬 (예: [[1,2],[3,4]])
  * **3차원 이상 텐서**: 영상, 시계열 데이터, 딥러닝에서 사용되는 고차원 데이터 구조

---

## 🔹 내적(Dot Product)

* **1D 텐서(벡터) 간 연산**에서 정의됨.
* 조건: 두 벡터의 차원이 동일해야 함.
* 결과: 스칼라 값.
* 예시:
  [
  [1,2,3] \cdot [4,5,6] = 1\times4 + 2\times5 + 3\times6 = 32
  ]

---

## 🔹 행렬 곱(Matrix Multiplication)

* 조건: 앞 행렬의 **열(column) 개수**와 뒤 행렬의 **행(row) 개수**가 같아야 함.
* 결과: 새로운 행렬이 생성됨.
* 예시:
  [
  A(2\times3) \times B(3\times4) \to C(2\times4)
  ]

---

## 🔹 Broadcasting

* **차원이 다른 두 텐서 간 연산을 가능하게 하는 규칙.**
* **조건**:

  1. 뒤에서부터 차원을 비교.
  2. 두 차원이 같거나, 둘 중 하나가 1이면 연산 가능.
* **불가능한 경우**:

  * 차원이 전혀 맞지 않을 때.
* 예시:

  * `[1,2,3] + 5 → [6,7,8]` (스칼라 확장)
  * `[[1,2,3],[4,5,6]] + [10,20,30] → [[11,22,33],[14,25,36]]`

---

## 🔹 Dense Tensor vs Sparse Tensor

### ✅ Dense Tensor

* 배열의 **모든 위치에 값을 저장**.
* **문제점**:

  1. 불필요한 0까지 모두 저장 → 메모리 낭비.
  2. 메모리 부족(Out of Memory, OOM) 발생 가능.
  3. 큰 계산량으로 연산 시간 증가.

### ✅ Sparse Tensor

* **0이 아닌 원소와 그 위치만 저장**.
* **장점**:

  1. 메모리 효율적 (특히 0이 많은 경우).
  2. 연산 속도 개선 가능.
* **단점**:

  * 데이터 구조가 복잡하여 직관성이 떨어짐.

---

## 🔹 Sparse Tensor 저장 방식

### 1. COO (Coordinate List)

* `(row_index, column_index, value)` 리스트 형태.
* 간단하지만 대규모 데이터에서는 비효율적일 수 있음.

### 2. CSR (Compressed Sparse Row)

* 구성 요소:

  * **row_pointer**: 각 행(row)의 시작 위치.
  * **column_index**: 각 값의 열(column) 인덱스.
  * **value**: 실제 0이 아닌 값.
* **장점**: 행(row) 기반 탐색이 빠름.

### 3. CSC (Compressed Sparse Column)

* 구성 요소:

  * **column_pointer**: 각 열(column)의 시작 위치.
  * **row_index**: 각 값의 행(row) 인덱스.
  * **value**: 실제 0이 아닌 값.
* **장점**: 열(column) 기반 탐색이 빠름.

---

## 🔹 CSR / CSC 비교

| 방식      | 저장 구조                              | 장점                        | 단점               |
| ------- | ---------------------------------- | ------------------------- | ---------------- |
| **COO** | (row, col, value) 리스트              | 구현이 간단                    | 중복된 좌표 발생 시 비효율적 |
| **CSR** | (row_pointer, column_index, value) | 행(row) 탐색 빠름, 메모리 효율 ↑    | 구조 복잡, 직관성 ↓     |
| **CSC** | (column_pointer, row_index, value) | 열(column) 탐색 빠름, 메모리 효율 ↑ | 구조 복잡, 직관성 ↓     |

---

## 📌 요약

* **Tensor**는 다차원 배열이며, 연산 규칙(내적, 행렬곱, 브로드캐스팅)에 따라 다르게 동작함.
* **Dense Tensor**는 직관적이지만 메모리 비효율적.
* **Sparse Tensor**는 대규모 희소 데이터(예: 그래프, 추천시스템, NLP 단어 임베딩)에 적합.
* 저장 방식으로는 **COO, CSR, CSC** 등이 있으며, 상황에 맞게 선택.

---
